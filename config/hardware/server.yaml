# config/hardware/server.yaml
# Профиль для мощного сервера (AMD 9900X 4.4 ГГц, 96 ГБ RAM, RTX 3090 24 ГБ)
# Максимальные настройки — бот работает на пределе возможностей железа
# Переопределяет default.yaml для максимальной точности и скорости

# Основные лимиты (почти без ограничений)
max_coins: 150                      # Максимум монет одновременно (100–200 — комфортно, дальше зависит от RAM и API-лимитов)
max_tf: 5                           # Все таймфреймы (1m, 3m, 5m, 10m, 15m)
max_windows: 4                      # Все окна (24, 50, 74, 100)
seq_len: 100                        # Полная длина последовательности (RTX 3090 легко справится)

# Производительность
low_power_mode: false               # Не нужен — сервер не ограничен батареей
use_tiny_model: false               # Полная модель (больше hidden_size, слоёв, точность)
quantization: "none"                # Без квантизации — float32 на GPU даёт максимум точности
inference_device: "cuda"            # cuda (RTX 3090) — inference ~10–30 мс на монету

# Параллелизация
parallel: true                      # Включить parallel backtest и PR-пересчёт (joblib/multiprocessing)
n_jobs: -1                          # Использовать все ядра CPU (AMD 9900X — 12 ядер/24 потока)

# Таймеры и частота (максимальная частота)
quiet_inference_every_by_tf:        # Таймер inference в тихом режиме (в свечах) — часто
  1m: 5                             # Каждые 5 минут на 1m
  3m: 4                             # Каждые 12 минут на 3m
  5m: 3                             # Каждые 15 минут на 5m
  10m: 2                            # Каждые 20 минут на 10m
  15m: 2                            # Каждые 30 минут на 15m

# PR-фильтр — максимально часто
pr:
  recalc_interval_minutes: 2        # Пересчёт PR каждые 2 минуты (RTX 3090 + 96 ГБ RAM — мгновенно)
  analysis_period_candles: 300      # Расширяем до 300 свечей (больше статистики, всё ещё актуально)
  min_deals_in_pr_period: 10        # Минимум 10 сделок — жёстче, чем на телефоне

# Оптимизация данных
data:
  max_history_candles: 5000000      # 5M свечей (≈5–10 лет на 1m — TimescaleDB + компрессия)
  resample_higher_tf: true          # Resample 1m → higher (экономит API-запросы)

# Модель и обучение
model:
  hidden_size: 128                  # Большой hidden (RTX 3090 легко потянет)
  conv_filters: 64                  # Полные фильтры Conv1D
  epochs: 100                       # Полное обучение (GPU ускорит)

# Дополнительно (сервер специфично)
server_safety:
  max_memory_gb: 80                 # Не использовать больше 80 ГБ RAM (оставляем запас)
  auto_save_interval_minutes: 15    # Сохранять модель/данные каждые 15 минут
  parallel_workers: 24              # Кол-во параллельных процессов (по числу потоков CPU)

# Логирование (максимум информации)
logging:
  level: "DEBUG"                    # DEBUG — всё видим
  file_max_mb: 100                  # 100 МБ на лог-файл
  shadow_trading: true              # Обязательно включено на сервере